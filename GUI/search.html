<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <title>Search Expenses</title>
</head>
<body>
    <h1>Search Expenses</h1>

        <p>To search your expenses, you can use the date range, amount range, category, or any combination of these. 
        Fill in one or more fields and click "Search". If no results match your criteria, 
        you'll see a message indicating no results were found.</p>
     

        <form method="GET" action="/search">
            <h2>Search by Date Range</h2>
            <label for="start_date">Start Date:</label>
            <input type="date" id="start_date" name="start_date" 
                {% if request.args.get('start_date') %}value="{{ request.args.get('start_date') }}"{% endif %}>
            <label for="end_date">End Date:</label>
            <input type="date" id="end_date" name="end_date"
                {% if request.args.get('end_date') %}value="{{ request.args.get('end_date') }}"{% endif %}>

            <h2>Search by Amount Range</h2>
            <div> 
                <label for="min_amount">Minimum Amount:</label>
                <input type="number" id="min_amount" name="min_amount" step="0.01"
                    {% if request.args.get('min_amount') %}value="{{ request.args.get('min_amount') }}"{% endif %}>
            </div>
            <div>
                <label for="max_amount">Maximum Amount:</label>
                <input type="number" id="max_amount" name="max_amount" step="0.01"
                    {% if request.args.get('max_amount') %}value="{{ request.args.get('max_amount') }}"{% endif %}>
            </div>

            <h2>Search by Category</h2>
            <select id="category" name="category">
                <option value="">--Select Category--</option>
                <option value="Groceries" {% if request.args.get('category') == "Groceries" %}selected{% endif %}>Groceries</option>
                <option value="Transportation" {% if request.args.get('category') == "Transportation" %}selected{% endif %}>Transportation</option>
                <option value="Entertainment" {% if request.args.get('category') == "Entertainment" %}selected{% endif %}>Entertainment</option>
                <option value="Dining" {% if request.args.get('category') == "Dining" %}selected{% endif %}>Dining</option>
                <option value="Healthcare" {% if request.args.get('category') == "Healthcare" %}selected{% endif %}>Healthcare</option>
                <option value="Rent/Utilities" {% if request.args.get('category') == "Rent/Utilities" %}selected{% endif %}>Rent/Utilities</option>
                <option value="Other" {% if request.args.get('category') == "Other" %}selected{% endif %}>Other</option>
            </select>
            
            <br><br>
            <button type="submit">Search</button>
        </form>

    <h2>Search Results</h2>
    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}

    <ul>
        {% if expenses is not none %}
            {% if expenses|length == 0 %}
                <p>No expenses found within the specified range.</p>
            {% else %}
                {% for expense in expenses %}
                    <li>{{ expense.date.strftime('%Y-%m-%d') }} - {{ expense.category }} - ${{ expense.amount }} - {{ expense.description }}
                        <a href="/edit/{{ expense._id }}">Edit</a>
                        <a href="/delete/{{ expense._id }}">Delete</a>
                    </li>
                {% endfor %}
            {% endif %}
        {% endif %}
    </ul>
</body>
</html>